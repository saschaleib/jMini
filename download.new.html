<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>jMini Download Page</title>
		<meta name="description" content="jMini Downloads.">
		<link rel="stylesheet" type="text/css" media="all" href="docs/_theme/global.css" />
		<link rel="stylesheet" type="text/css" media="all" href="docs/_theme/download.css" />
		<link rel="stylesheet" type="text/css" media="print" href="docs/_theme/print.css" />
		<!-- DEV ONLY: -->
		<script src="dev/events/Element.onClick.js" type="text/javascript"></script>
		<script src="dev/classes/Element.addClass.js" type="text/javascript"></script>
		<script src="dev/elements/Element.setText.js" type="text/javascript"></script>
		<script src="dev/elements/Element.setAttr.js" type="text/javascript"></script>
		<script src="dev/elements/HTMLElement.new.js" type="text/javascript"></script>
		<script src="dev/elements/Element.appendNew.js" type="text/javascript"></script>
		<script src="dev/arrays/Array.first.js" type="text/javascript"></script>
		<script src="dev/page/page_core.js" type="text/javascript"></script>
		<script src="dev/page/page_gui_core.js" type="text/javascript"></script>
		<script src="dev/page/page_gui_tabs.js" type="text/javascript"></script>
		<script type="text/javascript">
		
			$p.init = function() {
				console.info('$p.init()');
			}
			
			/* general settings */
			const kSettings = {
				basePath: 'http://code.kolmio.com/jmini/',
				devPath: 'dev/'
			}

			$p.data = {
				
				/* list of topics */
				topics: null,
				
				/* list of methods */
				methods: [],
				
				/* pre-init, here as an async function, because it contains network requests: */
				_init: async function() {
					
					let trg = document.getElementById('topic-list');
					
					/* load the index */
					let url = kSettings.basePath + kSettings.devPath + 'index.json';
					try {
						/* load the json from the server: */
						let topicsReq = await fetch(url, {
							method: 'GET',
							mode: 'no-cors',
							Accept: 'application/json',
							credentials: 'omit'
						});
						if (!topicsReq.ok) {
							throw new Error("Error #" + topicsReq.status + ", '" + topicsReq.statusText + "'");
						}
						let topicFile = await topicsReq.json();
						
						/* DEBUG: static result:
						let topicFile = {
							"version": "2023-10-24",
							"topics":[{
								"id": "elements",
								"title": "Elements",
								"desc": "Functions related to DOM Elements.",
								"path": "elements/",
								"size": 1208
							}]
						}; */
						/* end DEBUG alternative */
						
						/* keep a reference of the topics here: */
						$p.data.topics = topicFile.topics;

						/* load the sub-files and create cross-connections: */
						$p.data.topics.forEach( async function(topic) {

							topic._checkbox = $p.gui.builder.makeCheckbox(topic.id, 'tid');
							let section = $p.gui.builder.makeTopicGroup(topic, topic._checkbox);
							
							/* load the index */
							let url = kSettings.basePath + kSettings.devPath + topic.path + 'index.json';
							let methodsReq = await fetch(url, {
								method: 'GET',
								mode: 'no-cors',
								Accept: 'application/json',
								credentials: 'omit'
							});
							if (!methodsReq.ok) {
								throw new Error("Error #" + methodsReq.status + ", '" + methodsReq.statusText + "'");
							}
							let methodsFile = await methodsReq.json();
							/* load the method data:
							let methodsFile = [{
								"id": "htmlelement_addclass",
								"name": ".addClass",
								"namehtml": "<i>&lt;HTMLElement&gt;</i>.<b>addClass</b>",
								"type": "prototype",
								"desc": "Adds a class to the parent HTMLElement.",
								"file": "Element.addClass",
								"variants": [
								  {
									"sig": "<i>&lt;HTMLElement&gt;</i>.<b>addClass</b>(<i>&lt;String&gt;</i>)",
									"desc": "Adds a class to the internal classes list of the element.",
									"flags": [],
									"param": [
									  {
										"name": "classname",
										"type": "<i>&lt;String&gt;</i>",
										"desc": "The name of the class to add",
										"required": true
									  }
									],
									"returns": {
										"type": "<i>&lt;HTMLElement&gt;</i>",
										"desc": "The (modified) parent HTMLElement."
									}
								  }
								],
								"size": 78,
								"requires": [],
								"conflics": [],
								"moreinfo": "docs/classes/addClass.html"
							}]; */
							methodsFile.forEach( (method) => {
								method._checkbox = $p.gui.builder.makeCheckbox(method.id, 'mid');
								let item = $p.gui.builder.addMethodItem(method, section, method._checkbox);
							})
							
							trg.appendChild(section);
						});

					} catch(err) {
						console.error(err);
					}
				}
			}
			
			$p.gui.builder = {
				makeCheckbox: function(id, dtype) {
					return HTMLElement.new('input')
						.setAttr('type', 'checkbox')
						.setAttr('id', dtype+'-'+id)
						.setAttr('data-'+dtype, id);
				},
					
				makeTopicGroup: function(topic, cb) {
					let sum = HTMLElement.new('summary');
					sum.appendChild(cb);
					sum.appendNew('label')
						.setAttr('for', 'mid-'+topic.id)
						.addClass('tname')
						.setText(topic.title);
					sum.appendNew('span')
						.addClass('tdesc')
						.setText(topic.desc);
					sum.appendNew('span')
						.addClass('tsize')
						.setText(topic.size);
					let det = HTMLElement.new('details')
						.addClass('topic')
						.setAttr('data-tid', topic.id);
					det.appendChild(sum);
					return det;
				},
				
				addMethodItem: function(m, parent, checkbox) {
					let lbl = HTMLElement.new('label')
						.setAttr('id', 'grp_'+m.id);
					lbl.appendChild(checkbox);
					lbl.appendNew('code').addClass('mname').setText(m.name);
					lbl.appendNew('span').addClass('mdesc').setText(m.desc);
					lbl.appendNew('span').addClass('msize').setText(m.size);
					parent.appendChild(lbl);
				}
			}

		</script>
		<!-- END DEV ONLY -->
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="theme-color" content="#263238" />
	</head>
	<body data-pageid="classes:addClass">
		<nav id="pre-header">
			<div>
				<span class="label">jMini:</span>
				<ul>
					<li><a href="index.html">Home</a></li>
					<li class="active"><a href="download.html">Download</a></li>
					<li><a href="docs/index.html">Documentation</a></li>
				</ul>
			</div>
		</nav>
		<div id="header-layout">
			<header>
				<h1><a href="download.html">jMini Download</a></h1>
			</header>
		</div>
		<div id="main-layout">
			<main id="download-tool">
				<header>
					<input type="checkbox" id="globalCheckbox" title="select/unselect all">
					<span class="title">jMini Toolbox</span>
					<span id="dl-size">—</span>
				</header>
				<div id="topic-list"></div>
				<footer>
					<details id="footer-baking">
						<summary><span>Baking</span></summary>
						<ul role="tablist">
							<li role="presentation">
								<a role="tab" href="#baking-input" aria-controls="baking-input" id="bak-tab1" aria-selected="false">Text input</a>
							</li>
							<li role="presentation">
								<a role="tab" href="#baking-upload" aria-controls="baking-upload" id="bak-tab2" aria-selected="true">File upload</a>
							</li>
						</ul>
						<fieldset role="tabpanel" id="baking-input" aria-labelledby="bak-tab1" hidden>
							<textarea id="baking-text"></textarea>
						</fieldset>
						<fieldset role="tabpanel" id="baking-upload" aria-labelledby="bak-tab2">
							<input type="file">
						</fieldset>
					</details>
					<details id="footer-options">
						<summary><span>Options</span></summary>
						<fieldset>
							<input type="checkbox" id="chk_minify"><label for="chk_minify">Minify JS code</label><br>
							<input type="checkbox" id="chk_filenames"><label for="chk_filenames">Add filenames</label>
						</fieldset>
					</details>
					<div id="footer-buttons">
						<button type="submit" id="download-button">Download</button>
					</div>
				</footer>
			</main>
		</div>
		<div id="footer-layout">
			<footer>
				<p>jMini is licensed under the <a href="https://opensource.org/license/mit/" class="ext osi" target="_blank"><abbr>MIT</abbr> license</a>. For more information, please see this project’s <a href="https://github.com/saschaleib/jMini" class="ext github" target="_blank">GitHub Repository</a>.</p>
			</footer>
		</div>
	</body>
</html>